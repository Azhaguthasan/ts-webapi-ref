var CodeGenerator;!function(t){var e=function(){function t(){this.http=require("http"),this.https=require("https"),this.q=require("q"),this.endPointRegex=/^(http(?:s)*)\:\/\/([a-zA-Z.0-9]*)(?:\:){0,1}([0-9]*)((?=\/).*)$/}return t.prototype.getApi=function(t){var e=this.q.defer();if(!this.endPointRegex.test(t))throw new Error("Check url!!");var r=this.endPointRegex.exec(t),n="https"===r[1],i={rejectUnauthorized:!1,host:r[2],port:r[3],path:r[4],method:"GET"},o=n?this.https.get:this.http.get;return o(i,function(t){var r;t.on("data",function(t){r+=t}),t.on("end",function(){var t=/^undefined(.*)/,n=t.exec(r);if(void 0!==n&&0!==n.length){var i=JSON.parse(n[1]);return void e.resolve(i)}e.reject("failed")})}),e.promise},t}();t.ApiReader=e}(CodeGenerator||(CodeGenerator={}));
var CodeGenerator;!function(e){var t=function(){function t(){this.typescriptTypeMapper=new e.CodeDom.TypescriptTypeMapper,this.typescriptMemberGenerator=new e.CodeDom.TypescriptMemberGenerator(this.typescriptTypeMapper),this.typescriptTypeParameter=new e.CodeDom.TypescriptTypeParameter(this.typescriptTypeMapper),this.typescriptTypeGenerator=new e.CodeDom.TypescriptTypeGenerator(this.typescriptTypeMapper,this.typescriptMemberGenerator,this.typescriptTypeParameter),this.codeGenerator=new e.Generator.TypescriptCodeGenerator(this.typescriptTypeGenerator,this.typescriptTypeMapper)}return t.prototype.generateApi=function(t,r){var p=this,n=new e.Args(r),o=new e.ApiReader;o.getApi(t).then(function(e){try{p.codeGenerator.generateCode(n,e)}catch(t){console.log(t,t.stack.split("\n"))}})},t}();e.Startup=t}(CodeGenerator||(CodeGenerator={})),exports.generateApi=function(e,t){var r=new CodeGenerator.Startup;r.generateApi(e,t)};
var CodeGenerator;!function(e){var n=function(){function e(e){this.apiSuffix="Service",this.module="Service.Reference",this.fileName="Reference.ts",this.generateOnlyTypes=!1,this.generateTypesAsInterface=!1,this.generateTypesInSameModule=!1,e&&(e.apiSuffix&&(this.apiSuffix=e.apiSuffix),e.module&&(this.module=e.module),e.fileName&&(this.fileName=e.fileName),e.generateOnlyTypes&&(this.generateOnlyTypes=e.generateOnlyTypes),e.generateTypesAsInterface&&(this.generateTypesAsInterface=e.generateTypesAsInterface),e.generateTypesInSameModule&&(this.generateTypesInSameModule=e.generateTypesInSameModule))}return e}();e.Args=n}(CodeGenerator||(CodeGenerator={}));
var CodeGenerator;!function(e){var t;!function(t){var n=function(){function t(e,t){this.typescriptTypeMapper=t,this.typescriptTypeGenerator=e,this.filesystem=require("fs"),this.path=require("path"),this.wrench=require("wrench"),this.types=new Array}return t.prototype.generateCode=function(e,t){var n=this,r="",a=e.fileName,p=e.apiSuffix,s=e.module,o=e.generateOnlyTypes,i=e.generateTypesAsInterface,u=e.generateTypesInSameModule;t.forEach(function(e,t,r){n.populateTypes(e)}),i&&this.convertToInterfaces(),u&&this.changeTypesToLocalNamespace(s),r+=this.generateTypes(),o||(r+=this.generateServices(t,p,s));var m=this.path.dirname(a);m&&""!==m&&this.wrench.mkdirSyncRecursive(m),this.filesystem.writeFileSync(a,r)},t.prototype.convertToInterfaces=function(){this.types.filter(function(e){return null!==e.fullName&&-1===e.fullName.indexOf("System")&&!e.isEnum}).forEach(function(e){e.isInterface=!0,e.name="I"+e.name,e.fullName=e.namespace+"."+e.name})},t.prototype.changeTypesToLocalNamespace=function(e){this.types.filter(function(e){return null!==e.fullName&&-1===e.fullName.indexOf("System")}).forEach(function(t){t.namespace=e,t.fullName=t.namespace+"."+t.name})},t.prototype.generateServices=function(e,t,n){var r=this,a="",p=e.groupBy(function(e){return e.controllerName});return p.forEach(function(e,p,s){a+=r.generateInterface(e,t,n),a+=r.generateImplementation(e,t,n)}),a},t.prototype.populateTypes=function(e){var t=this,n=this.getTypeInfos(e.responseType);this.types.pushRange(n),null!==e.parameterDescriptions&&e.parameterDescriptions.hasAny()&&e.parameterDescriptions.forEach(function(e){var n=t.getTypeInfos(e.type);t.types.pushRange(n)})},t.prototype.generateTypes=function(){var e=this,t="",n=this.types.groupBy(function(e){return e.name}),r=n.map(function(e){return e.first()}).filter(function(e){return e.fullName&&-1===e.fullName.indexOf("System")});return r&&r.hasAny()&&r.forEach(function(n){var r=e.typescriptTypeGenerator.generateType(n);t+=r}),t},t.prototype.getTypeInfos=function(e){var t=this,n=new Array;if(!e)return n;if(n.push(e),e.baseType){var r=this.getTypeInfos(e.baseType);n.pushRange(r)}return e.typeArguments&&e.typeArguments.hasAny()&&e.typeArguments.forEach(function(e){var r=t.getTypeInfos(e);n.pushRange(r)}),e.properties&&e.properties.hasAny()&&e.properties.forEach(function(e){var r=t.getTypeInfos(e.type);n.pushRange(r)}),n},t.prototype.generateInterface=function(t,n,r){var a=new e.CodeDom.TypeInfo,p=t.first();return a.namespace=r,a.name="I"+p.controllerName+n,a.isInterface=!0,a.fullName=r+"."+a.name,a.methods=new Array,t.forEach(function(t){var n=new e.CodeDom.MethodInfo;n.name=t.actionName,n.parameters=t.parameterDescriptions;var r=new e.CodeDom.TypeInfo;if(r.typeArguments=new Array,t.responseType)r.typeArguments.push(t.responseType);else{var p=new e.CodeDom.TypeInfo;p.name="Object",p.namespace="System",p.fullName=p.namespace+"."+p.name,r.typeArguments.push(p)}r.name="IPromise",r.namespace="angular",r.fullName=r.namespace+"."+r.name,n.returnType=r,a.methods.push(n)}),this.typescriptTypeGenerator.generateType(a)},t.prototype.generateImplementation=function(t,n,r){var a=this,p=new e.CodeDom.TypeInfo,s=t.first();p.namespace=r,p.name=s.controllerName+n,p.fullName=r+"."+p.name,p.methods=new Array;var o=new e.CodeDom.PropertyInfo;o.name="static $inject",o.hasValue=!0,o.value='[ "$httpService" ]',p.properties.push(o);var i=new e.CodeDom.MethodInfo;i.name="constructor",i.isConstructor=!0,i.parameters=new Array;var u=new e.CodeDom.ParameterDescription;return u.name="private $httpService",u.type=new e.CodeDom.TypeInfo,u.type.name="IHttpService",u.type.namespace="angular",u.type.fullName=u.type.namespace+"."+u.type.name,i.parameters.push(u),p.methods.push(i),t.forEach(function(t){var n=new e.CodeDom.MethodInfo;n.name=t.actionName,n.parameters=t.parameterDescriptions;var r=new e.CodeDom.TypeInfo;if(r.typeArguments=new Array,t.responseType)r.typeArguments.push(t.responseType);else{var s=new e.CodeDom.TypeInfo;s.name="Object",s.namespace="System",s.fullName=s.namespace+"."+s.name,r.typeArguments.push(s)}r.name="IPromise",r.namespace="angular",r.fullName=r.namespace+"."+r.name,n.returnType=r,n.statements=a.getStatements(t),p.methods.push(n)}),this.typescriptTypeGenerator.generateType(p)},t.prototype.getStatements=function(e){var t=new Array;return t.push("var httpServiceRequest = {"),t.push('	method: "'+e.httpMethod+'",'),t.push('	url: "'+e.relativePath+'",'),t.push("	data: {"),e.parameterDescriptions.forEach(function(e){t.push("		"+e.name+": "+e.name+",")}),t.push("	}"),t.push("};"),t.push("var promise = this.$httpService(httpServiceRequest)"),e.responseType?t.push("	.then((httpServiceResponse: angular.IHttpPromiseCallbackArg<"+this.typescriptTypeMapper.getTypeOutput(e.responseType)+">) => {"):t.push("	.then((httpServiceResponse: angular.IHttpPromiseCallbackArg<any>) => {"),t.push("		return httpServiceResponse.data;"),t.push("	});"),t.push("return promise;"),t},t}();t.TypescriptCodeGenerator=n}(t=e.Generator||(e.Generator={}))}(CodeGenerator||(CodeGenerator={}));

!function(){function r(){var r=this;return r.length>0}function t(){var r=this;return r.hasAny()?r[0]:void 0}function n(){var r=this;return r.hasAny()?r[r.length-1]:void 0}function o(r){var t=this;if(!t.hasAny())return void 0;for(var n=0;n<t.length;n++){var o=t[n];if(r(o))return o}return void 0}function i(r){var t=new Array,n=this;return n.forEach(function(n,o,i){var e=t.firstMatch(function(t){return r(t.first())===r(n)});if(null==e){var a=new Array;a.push(n),t.push(a)}else e.push(n)}),t}function e(r){var t,n=this;if(!n.hasAny())return n;var o=n.first(),i=r(o);return t="number"==typeof i?function(r,t){return r>t?-1:t>r?1:0}:"boolean"==typeof i?function(r,t){return r&&!t?-1:!r&&t?1:0}:function(r,t){return void 0!=r&&void 0==t?1:void 0==r&&void 0!=t?-1:0},n.sort(t)}function a(){var r=this;r=[],r.length=0}function u(r){var t=this;return t.slice(0,r)}function f(r){var t=this;r.forEach(function(r){t.push(r)})}Array.prototype.hasAny=r,Array.prototype.first=t,Array.prototype.last=n,Array.prototype.firstMatch=o,Array.prototype.groupBy=i,Array.prototype.orderBy=e,Array.prototype.clear=a,Array.prototype.take=u,Array.prototype.pushRange=f}();
var CodeGenerator;!function(o){var e;!function(o){var e=function(){function o(){}return o}();o.ApiDescription=e}(e=o.CodeDom||(o.CodeDom={}))}(CodeGenerator||(CodeGenerator={}));
var CodeGenerator;!function(o){var e;!function(o){var e=function(){function o(){}return o}();o.MethodInfo=e}(e=o.CodeDom||(o.CodeDom={}))}(CodeGenerator||(CodeGenerator={}));
var CodeGenerator;!function(e){var o;!function(e){var o=function(){function e(){}return e}();e.ParameterDescription=o}(o=e.CodeDom||(e.CodeDom={}))}(CodeGenerator||(CodeGenerator={}));
var CodeGenerator;!function(o){var e;!function(o){var e=function(){function o(){}return o}();o.PropertyInfo=e}(e=o.CodeDom||(o.CodeDom={}))}(CodeGenerator||(CodeGenerator={}));
var CodeGenerator;!function(o){var e;!function(o){var e=function(){function o(){}return o}();o.TypeInfo=e}(e=o.CodeDom||(o.CodeDom={}))}(CodeGenerator||(CodeGenerator={}));

var CodeGenerator;!function(t){var e;!function(t){var e=function(){function t(){this.baseTypeRegex=/(([a-zA-Z]+[0-9.]*)+)/,this.arrayRegex=/^([a-zA-Z0-9\.]+)(?:[`0-9]*)\[((?:\]\[)*|(?:,)*)\]$/,this.typeMap={},this.addAllKnownTypes()}return t.prototype.addAllKnownTypes=function(){this.typeMap["System.Int32"]="number",this.typeMap["System.UInt32"]="number",this.typeMap["System.Int64"]="number",this.typeMap["System.UInt64"]="number",this.typeMap["System.Int16"]="number",this.typeMap["System.UInt16"]="number",this.typeMap["System.Single"]="number",this.typeMap["System.Double"]="number",this.typeMap["System.Decimal"]="number",this.typeMap["System.Byte"]="number",this.typeMap["System.String"]="string",this.typeMap["System.Guid"]="string",this.typeMap["System.Boolean"]="boolean",this.typeMap["System.Void"]="void",this.typeMap["System.Object"]="any",this.typeMap["System.DateTime"]="Date",this.typeMap["System.DateTimeOffset"]="Date",this.typeMap["System.Collections.Generic.List"]="Array",this.typeMap["System.Collections.Generic.IList"]="Array",this.typeMap["System.Collections.Generic.IEnumerable"]="Array",this.typeMap["System.Collections.IEnumerable"]="Array",this.typeMap["System.Linq.IQueryable"]="Array",this.typeMap["System.Array"]="Array"},t.prototype.isValidTypeForDerivation=function(t){return"System.Object"!==t.fullName&&"System.ValueType"!==t.fullName},t.prototype.isCollectionType=function(t){var e=this.getActualTypeName(t);return"System.Collections.Generic.List"===e||"System.Collections.Generic.IList"===e||"System.Collections.Generic.IEnumerable"===e||"System.Collections.IEnumerable"===e||"System.Linq.IQueryable"===e||"System.Array"===e},t.prototype.getActualTypeName=function(t){var e=this.baseTypeRegex.exec(t.fullName);if(!e||0===e.length)throw new Error("Type mismatch");return e[0]},t.prototype.getTypeOutput=function(t){var e,r=this.getActualTypeName(t),n=/nullable/i;return n.test(r)?e=this.getTypeArgument(t):(e=this.translateType(r),t.typeArguments&&t.typeArguments.hasAny()&&(e=this.addTypeArguments(t,e))),this.arrayRegex.test(t.name)&&(e=this.getArrayType(t.name,e)),e},t.prototype.addTypeArguments=function(t,e){var r=this,n=t.typeArguments.map(function(t){return r.getTypeOutput(t)});return e+"<"+n.join(", ")+">"},t.prototype.getTypeArgument=function(t){var e=this,r=t.typeArguments.map(function(t){return e.getTypeOutput(t)});return r.join(", ")},t.prototype.translateType=function(t){return this.typeMap.hasOwnProperty(t)?this.typeMap[t]:t},t.prototype.getArrayType=function(t,e){var r=this.arrayRegex.exec(t),n="]"===r[2].charAt(0)?r[2].length/2:0,y=","===r[2].charAt(0)?r[2].length:0;return n>0?this.getArrayString(e,n+1):y>0?this.getArrayString(e,y+1):this.getArrayString(e,1)},t.prototype.getArrayString=function(t,e){return 0===e?t:"Array<"+this.getArrayString(t,e-1)+">"},t}();t.TypescriptTypeMapper=e}(e=t.CodeDom||(t.CodeDom={}))}(CodeGenerator||(CodeGenerator={}));
var CodeGenerator;!function(e){var t;!function(e){var t=function(){function e(e){this.typescriptTypeMapper=e,this.os=require("os")}return e.prototype.generateMember=function(e){var t=this.convertPascalCaseToCamelCase(e.name);return e.isEnumMember?t+" = "+e.enumValue+",":e.hasValue?t+": "+this.typescriptTypeMapper.getTypeOutput(e.type)+" = "+e.value:t+": "+this.typescriptTypeMapper.getTypeOutput(e.type)+";"},e.prototype.generateMethod=function(e,t){var r=this,a=this.convertPascalCaseToCamelCase(e.name),n="";if(e.parameters&&e.parameters.hasAny()){var s=e.parameters.map(function(e){return r.generateParameter(e)});n=s.join(", ")}var o=e.returnType?this.typescriptTypeMapper.getTypeOutput(e.returnType):"void";if(e.statements&&e.statements.hasAny()){var p=this.getIndentTabs(t+1),i=this.getIndentTabs(t),u=e.statements.join(this.os.EOL+p);return a+"("+n+"): "+o+"{"+this.os.EOL+p+u+this.os.EOL+i+"}"+this.os.EOL}if(e.isConstructor){var p=this.getIndentTabs(t);return"constructor("+n+") {"+this.os.EOL+p+"}"}return a+": ("+n+") => "+o+";"},e.prototype.getIndentTabs=function(e){for(var t="",r=0;e>r;r++)t+="	";return t},e.prototype.generateParameter=function(e){var t=this.convertPascalCaseToCamelCase(e.name),r=this.typescriptTypeMapper.getTypeOutput(e.type);return t+": "+r},e.prototype.convertPascalCaseToCamelCase=function(e){if(!e||e.length<=0)return"";var t=e[0].toString().toLowerCase();return t+e.substr(1,e.length-1)},e}();e.TypescriptMemberGenerator=t}(t=e.CodeDom||(e.CodeDom={}))}(CodeGenerator||(CodeGenerator={}));
var CodeGenerator;!function(e){var t;!function(e){var t=function(){function e(e,t,r){this.typescriptTypeParameter=r,this.typescriptMemberGenerator=t,this.typescriptTypeMapper=e,this.os=require("os")}return e.prototype.generateType=function(e){var t=this.getType(e),r=e.namespace&&e.namespace.length>0;return r?this.wrapWithModule(e,t):t},e.prototype.getType=function(e){var t=this,r=e.namespace&&e.namespace.length>0,n=r?1:0,s=r?"export ":"",p=e.name,a=this.getTypeOfType(e),i="";if(e.properties&&e.properties.hasAny()){var o=e.properties.map(function(e){return t.typescriptMemberGenerator.generateMember(e)});i=this.os.EOL+this.getIndentTabs(n+1)+o.join(this.os.EOL+this.getIndentTabs(n+1))+this.os.EOL}var y="";if(e.methods&&e.methods.hasAny()){var h=e.methods.map(function(e){return t.typescriptMemberGenerator.generateMethod(e,n+1)});y=this.os.EOL+this.getIndentTabs(n+1)+h.join(this.os.EOL+this.getIndentTabs(n+1))+this.os.EOL}var u="";if(e.typeArguments&&e.typeArguments.hasAny()){var c=e.typeArguments.map(function(e){return t.typescriptTypeParameter.generateParameter(e)});c.hasAny()&&(u="<"+c.join(", ")+">")}var m="";return!e.isEnum&&e.baseType&&this.typescriptTypeMapper.isValidTypeForDerivation(e.baseType)&&(m=" extends "+this.typescriptTypeMapper.getTypeOutput(e.baseType)),this.getIndentTabs(n)+s+a+p+u+m+" {"+i+y+this.getIndentTabs(n)+"}"},e.prototype.getIndentTabs=function(e){for(var t="",r=0;e>r;r++)t+="	";return t},e.prototype.getTypeOfType=function(e){return e.isEnum?"enum ":e.isInterface?"interface ":"class "},e.prototype.wrapWithModule=function(e,t){return"module "+e.namespace+" {"+this.os.EOL+t+this.os.EOL+"}"+this.os.EOL},e}();e.TypescriptTypeGenerator=t}(t=e.CodeDom||(e.CodeDom={}))}(CodeGenerator||(CodeGenerator={}));
var CodeGenerator;!function(e){var t;!function(e){var t=function(){function e(e){this.typescriptTypeMapper=e}return e.prototype.generateParameter=function(e){var t="";if(e.typeArguments.length>0){var r=e.typeArguments.first(),n=this.typescriptTypeMapper.getTypeOutput(r);t=" extends "+n}return e.name+t},e}();e.TypescriptTypeParameter=t}(t=e.CodeDom||(e.CodeDom={}))}(CodeGenerator||(CodeGenerator={}));